import matplotlib.pyplot as plt
import json
import time
from datetime import datetime
from problem import MDMSMCVRPProblem
from abc_solver import MDMSMCVRP_ABC
from optimization import optimize_with_optuna


def load_problem_data():
    """Load the problem data (replace with your actual data)"""
    VD = ['D1', 'D2', 'D3', 'D4', 'D5', 'D6', 'D7', 'D8', 'D9', 'D10']
    VS = ['S1', 'S2']
    VC = ['C1', 'C2', 'C3', 'C4', 'C5', 'C6', 'C7', 'C8', 'C9', 'C10',
          'C11', 'C12', 'C13', 'C14', 'C15', 'C16', 'C17', 'C18', 'C19', 'C20',
          'C21', 'C22', 'C23', 'C24', 'C25', 'C26', 'C27', 'C28', 'C29', 'C30',
          'C31', 'C32', 'C33', 'C34', 'C35', 'C36', 'C37', 'C38', 'C39', 'C40', 'C41']

    # IMPORTANT: Replace these with your actual data dictionaries
    # Example structure (you need to fill with your complete data):
    distances = {'D1': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                        'D9': 9999, 'D10': 9999, 'S1': 940.0, 'S2': 910, 'C1': 9999.0, 'C2': 9999, 'C3': 9999,
                        'C4': 9999, 'C5': 9999, 'C6': 9999, 'C7': 9999, 'C8': 9999, 'C9': 9999, 'C10': 9999,
                        'C11': 9999.0, 'C12': 9999, 'C13': 9999, 'C14': 9999, 'C15': 9999, 'C16': 9999, 'C17': 9999,
                        'C18': 9999, 'C19': 9999, 'C20': 9999, 'C21': 9999, 'C22': 9999, 'C23': 9999, 'C24': 9999.0,
                        'C25': 9999, 'C26': 9999, 'C27': 9999, 'C28': 9999.0, 'C29': 9999, 'C30': 9999, 'C31': 9999,
                        'C32': 9999, 'C33': 9999, 'C34': 9999, 'C35': 9999, 'C36': 9999, 'C37': 9999, 'C38': 9999,
                        'C39': 9999, 'C40': 9999, 'C41': 9999},
                 'D2': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                        'D9': 9999, 'D10': 9999, 'S1': 295.0, 'S2': 105, 'C1': 9999.0, 'C2': 9999, 'C3': 9999,
                        'C4': 9999, 'C5': 9999, 'C6': 9999, 'C7': 9999, 'C8': 9999, 'C9': 9999, 'C10': 9999,
                        'C11': 9999.0, 'C12': 9999, 'C13': 9999, 'C14': 9999, 'C15': 9999, 'C16': 9999, 'C17': 9999,
                        'C18': 9999, 'C19': 9999, 'C20': 9999, 'C21': 9999, 'C22': 9999, 'C23': 9999, 'C24': 9999.0,
                        'C25': 9999, 'C26': 9999, 'C27': 9999, 'C28': 9999.0, 'C29': 9999, 'C30': 9999, 'C31': 9999,
                        'C32': 9999, 'C33': 9999, 'C34': 9999, 'C35': 9999, 'C36': 9999, 'C37': 9999, 'C38': 9999,
                        'C39': 9999, 'C40': 9999, 'C41': 9999},
                 'D3': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                        'D9': 9999, 'D10': 9999, 'S1': 250.0, 'S2': 320, 'C1': 9999.0, 'C2': 9999, 'C3': 9999,
                        'C4': 9999, 'C5': 9999, 'C6': 9999, 'C7': 9999, 'C8': 9999, 'C9': 9999, 'C10': 9999,
                        'C11': 9999.0, 'C12': 9999, 'C13': 9999, 'C14': 9999, 'C15': 9999, 'C16': 9999, 'C17': 9999,
                        'C18': 9999, 'C19': 9999, 'C20': 9999, 'C21': 9999, 'C22': 9999, 'C23': 9999, 'C24': 9999.0,
                        'C25': 9999, 'C26': 9999, 'C27': 9999, 'C28': 9999.0, 'C29': 9999, 'C30': 9999, 'C31': 9999,
                        'C32': 9999, 'C33': 9999, 'C34': 9999, 'C35': 9999, 'C36': 9999, 'C37': 9999, 'C38': 9999,
                        'C39': 9999, 'C40': 9999, 'C41': 9999},
                 'D4': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                        'D9': 9999, 'D10': 9999, 'S1': 320.0, 'S2': 130, 'C1': 9999.0, 'C2': 9999, 'C3': 9999,
                        'C4': 9999, 'C5': 9999, 'C6': 9999, 'C7': 9999, 'C8': 9999, 'C9': 9999, 'C10': 9999,
                        'C11': 9999.0, 'C12': 9999, 'C13': 9999, 'C14': 9999, 'C15': 9999, 'C16': 9999, 'C17': 9999,
                        'C18': 9999, 'C19': 9999, 'C20': 9999, 'C21': 9999, 'C22': 9999, 'C23': 9999, 'C24': 9999.0,
                        'C25': 9999, 'C26': 9999, 'C27': 9999, 'C28': 9999.0, 'C29': 9999, 'C30': 9999, 'C31': 9999,
                        'C32': 9999, 'C33': 9999, 'C34': 9999, 'C35': 9999, 'C36': 9999, 'C37': 9999, 'C38': 9999,
                        'C39': 9999, 'C40': 9999, 'C41': 9999},
                 'D5': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                        'D9': 9999, 'D10': 9999, 'S1': 1530.0, 'S2': 1650, 'C1': 9999.0, 'C2': 9999, 'C3': 9999,
                        'C4': 9999, 'C5': 9999, 'C6': 9999, 'C7': 9999, 'C8': 9999, 'C9': 9999, 'C10': 9999,
                        'C11': 9999.0, 'C12': 9999, 'C13': 9999, 'C14': 9999, 'C15': 9999, 'C16': 9999, 'C17': 9999,
                        'C18': 9999, 'C19': 9999, 'C20': 9999, 'C21': 9999, 'C22': 9999, 'C23': 9999, 'C24': 9999.0,
                        'C25': 9999, 'C26': 9999, 'C27': 9999, 'C28': 9999.0, 'C29': 9999, 'C30': 9999, 'C31': 9999,
                        'C32': 9999, 'C33': 9999, 'C34': 9999, 'C35': 9999, 'C36': 9999, 'C37': 9999, 'C38': 9999,
                        'C39': 9999, 'C40': 9999, 'C41': 9999},
                 'D6': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                        'D9': 9999, 'D10': 9999, 'S1': 320.0, 'S2': 130, 'C1': 9999.0, 'C2': 9999, 'C3': 9999,
                        'C4': 9999, 'C5': 9999, 'C6': 9999, 'C7': 9999, 'C8': 9999, 'C9': 9999, 'C10': 9999,
                        'C11': 9999.0, 'C12': 9999, 'C13': 9999, 'C14': 9999, 'C15': 9999, 'C16': 9999, 'C17': 9999,
                        'C18': 9999, 'C19': 9999, 'C20': 9999, 'C21': 9999, 'C22': 9999, 'C23': 9999, 'C24': 9999.0,
                        'C25': 9999, 'C26': 9999, 'C27': 9999, 'C28': 9999.0, 'C29': 9999, 'C30': 9999, 'C31': 9999,
                        'C32': 9999, 'C33': 9999, 'C34': 9999, 'C35': 9999, 'C36': 9999, 'C37': 9999, 'C38': 9999,
                        'C39': 9999, 'C40': 9999, 'C41': 9999},
                 'D7': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                        'D9': 9999, 'D10': 9999, 'S1': 1530.0, 'S2': 1650, 'C1': 9999.0, 'C2': 9999, 'C3': 9999,
                        'C4': 9999, 'C5': 9999, 'C6': 9999, 'C7': 9999, 'C8': 9999, 'C9': 9999, 'C10': 9999,
                        'C11': 9999.0, 'C12': 9999, 'C13': 9999, 'C14': 9999, 'C15': 9999, 'C16': 9999, 'C17': 9999,
                        'C18': 9999, 'C19': 9999, 'C20': 9999, 'C21': 9999, 'C22': 9999, 'C23': 9999, 'C24': 9999.0,
                        'C25': 9999, 'C26': 9999, 'C27': 9999, 'C28': 9999.0, 'C29': 9999, 'C30': 9999, 'C31': 9999,
                        'C32': 9999, 'C33': 9999, 'C34': 9999, 'C35': 9999, 'C36': 9999, 'C37': 9999, 'C38': 9999,
                        'C39': 9999, 'C40': 9999, 'C41': 9999},
                 'D8': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                        'D9': 9999, 'D10': 9999, 'S1': 320.0, 'S2': 130, 'C1': 9999.0, 'C2': 9999, 'C3': 9999,
                        'C4': 9999, 'C5': 9999, 'C6': 9999, 'C7': 9999, 'C8': 9999, 'C9': 9999, 'C10': 9999,
                        'C11': 9999.0, 'C12': 9999, 'C13': 9999, 'C14': 9999, 'C15': 9999, 'C16': 9999, 'C17': 9999,
                        'C18': 9999, 'C19': 9999, 'C20': 9999, 'C21': 9999, 'C22': 9999, 'C23': 9999, 'C24': 9999.0,
                        'C25': 9999, 'C26': 9999, 'C27': 9999, 'C28': 9999.0, 'C29': 9999, 'C30': 9999, 'C31': 9999,
                        'C32': 9999, 'C33': 9999, 'C34': 9999, 'C35': 9999, 'C36': 9999, 'C37': 9999, 'C38': 9999,
                        'C39': 9999, 'C40': 9999, 'C41': 9999},
                 'D9': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                        'D9': 9999, 'D10': 9999, 'S1': 295.0, 'S2': 105, 'C1': 9999.0, 'C2': 9999, 'C3': 9999,
                        'C4': 9999, 'C5': 9999, 'C6': 9999, 'C7': 9999, 'C8': 9999, 'C9': 9999, 'C10': 9999,
                        'C11': 9999.0, 'C12': 9999, 'C13': 9999, 'C14': 9999, 'C15': 9999, 'C16': 9999, 'C17': 9999,
                        'C18': 9999, 'C19': 9999, 'C20': 9999, 'C21': 9999, 'C22': 9999, 'C23': 9999, 'C24': 9999.0,
                        'C25': 9999, 'C26': 9999, 'C27': 9999, 'C28': 9999.0, 'C29': 9999, 'C30': 9999, 'C31': 9999,
                        'C32': 9999, 'C33': 9999, 'C34': 9999, 'C35': 9999, 'C36': 9999, 'C37': 9999, 'C38': 9999,
                        'C39': 9999, 'C40': 9999, 'C41': 9999},
                 'D10': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 295.0, 'S2': 105, 'C1': 9999.0, 'C2': 9999, 'C3': 9999,
                         'C4': 9999, 'C5': 9999, 'C6': 9999, 'C7': 9999, 'C8': 9999, 'C9': 9999, 'C10': 9999,
                         'C11': 9999.0, 'C12': 9999, 'C13': 9999, 'C14': 9999, 'C15': 9999, 'C16': 9999, 'C17': 9999,
                         'C18': 9999, 'C19': 9999, 'C20': 9999, 'C21': 9999, 'C22': 9999, 'C23': 9999, 'C24': 9999.0,
                         'C25': 9999, 'C26': 9999, 'C27': 9999, 'C28': 9999.0, 'C29': 9999, 'C30': 9999, 'C31': 9999,
                         'C32': 9999, 'C33': 9999, 'C34': 9999, 'C35': 9999, 'C36': 9999, 'C37': 9999, 'C38': 9999,
                         'C39': 9999, 'C40': 9999, 'C41': 9999},
                 'S1': {'D1': 940, 'D2': 295, 'D3': 250, 'D4': 320, 'D5': 1530, 'D6': 320, 'D7': 1530, 'D8': 320,
                        'D9': 295, 'D10': 295, 'S1': 0.0, 'S2': 187, 'C1': 0.05, 'C2': 135, 'C3': 90, 'C4': 45,
                        'C5': 110, 'C6': 125, 'C7': 30, 'C8': 45, 'C9': 18, 'C10': 31, 'C11': 70.0, 'C12': 72,
                        'C13': 27, 'C14': 120, 'C15': 110, 'C16': 100, 'C17': 53, 'C18': 125, 'C19': 18, 'C20': 20,
                        'C21': 110, 'C22': 20, 'C23': 115, 'C24': 125.0, 'C25': 100, 'C26': 15, 'C27': 45, 'C28': 130.0,
                        'C29': 25, 'C30': 175, 'C31': 125, 'C32': 55, 'C33': 5, 'C34': 169, 'C35': 199, 'C36': 182,
                        'C37': 189, 'C38': 209, 'C39': 235, 'C40': 211, 'C41': 206},
                 'S2': {'D1': 910, 'D2': 105, 'D3': 320, 'D4': 130, 'D5': 1650, 'D6': 130, 'D7': 1650, 'D8': 130,
                        'D9': 105, 'D10': 105, 'S1': 187.0, 'S2': 0, 'C1': 124.0, 'C2': 100, 'C3': 203, 'C4': 150,
                        'C5': 164, 'C6': 100, 'C7': 191, 'C8': 109, 'C9': 200, 'C10': 153, 'C11': 155.0, 'C12': 147,
                        'C13': 213, 'C14': 69, 'C15': 122, 'C16': 98, 'C17': 124, 'C18': 144, 'C19': 111, 'C20': 144,
                        'C21': 153, 'C22': 184, 'C23': 134, 'C24': 150.0, 'C25': 116, 'C26': 164, 'C27': 100,
                        'C28': 146.0, 'C29': 131, 'C30': 87, 'C31': 220, 'C32': 77, 'C33': 127, 'C34': 4, 'C35': 22,
                        'C36': 42, 'C37': 15, 'C38': 30, 'C39': 50, 'C40': 35, 'C41': 20},
                 'C1': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                        'D9': 9999, 'D10': 9999, 'S1': 0.05, 'S2': 124, 'C1': 0.0, 'C2': 33, 'C3': 103, 'C4': 128,
                        'C5': 94, 'C6': 26, 'C7': 67, 'C8': 20, 'C9': 91, 'C10': 94, 'C11': 103.0, 'C12': 95,
                        'C13': 113, 'C14': 55, 'C15': 121, 'C16': 30, 'C17': 18, 'C18': 20, 'C19': 24, 'C20': 20,
                        'C21': 102, 'C22': 84, 'C23': 12, 'C24': 119.0, 'C25': 37, 'C26': 40, 'C27': 46, 'C28': 124.0,
                        'C29': 112, 'C30': 96, 'C31': 120, 'C32': 46, 'C33': 3, 'C34': 105, 'C35': 133, 'C36': 109,
                        'C37': 124, 'C38': 142, 'C39': 168, 'C40': 145, 'C41': 140},
                 'C2': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                        'D9': 9999, 'D10': 9999, 'S1': 135.0, 'S2': 100, 'C1': 33.0, 'C2': 0, 'C3': 103, 'C4': 128,
                        'C5': 94, 'C6': 26, 'C7': 68, 'C8': 21, 'C9': 91, 'C10': 95, 'C11': 103.0, 'C12': 59,
                        'C13': 140, 'C14': 34, 'C15': 115, 'C16': 16, 'C17': 38, 'C18': 52, 'C19': 26, 'C20': 47,
                        'C21': 130, 'C22': 112, 'C23': 35, 'C24': 142.0, 'C25': 47, 'C26': 68, 'C27': 33, 'C28': 138.0,
                        'C29': 123, 'C30': 76, 'C31': 147, 'C32': 26, 'C33': 33, 'C34': 84, 'C35': 98, 'C36': 89,
                        'C37': 98, 'C38': 117, 'C39': 146, 'C40': 120, 'C41': 115},
                 'C3': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                        'D9': 9999, 'D10': 9999, 'S1': 90.0, 'S2': 203, 'C1': 103.0, 'C2': 103, 'C3': 0, 'C4': 85,
                        'C5': 43, 'C6': 130, 'C7': 34, 'C8': 123, 'C9': 33, 'C10': 200, 'C11': 50.0, 'C12': 57,
                        'C13': 11, 'C14': 158, 'C15': 82, 'C16': 132, 'C17': 123, 'C18': 121, 'C19': 126, 'C20': 85,
                        'C21': 58, 'C22': 19, 'C23': 115, 'C24': 73.0, 'C25': 141, 'C26': 86, 'C27': 147, 'C28': 78.0,
                        'C29': 74, 'C30': 122, 'C31': 15, 'C32': 149, 'C33': 102, 'C34': 190, 'C35': 195, 'C36': 219,
                        'C37': 203, 'C38': 219, 'C39': 255, 'C40': 212, 'C41': 223},
                 'C4': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                        'D9': 9999, 'D10': 9999, 'S1': 45.0, 'S2': 150, 'C1': 128.0, 'C2': 128, 'C3': 85, 'C4': 0,
                        'C5': 46, 'C6': 155, 'C7': 82, 'C8': 143, 'C9': 85, 'C10': 224, 'C11': 37.0, 'C12': 32,
                        'C13': 91, 'C14': 118, 'C15': 27, 'C16': 133, 'C17': 147, 'C18': 145, 'C19': 58, 'C20': 109,
                        'C21': 27, 'C22': 70, 'C23': 139, 'C24': 9.0, 'C25': 165, 'C26': 110, 'C27': 126, 'C28': 5.0,
                        'C29': 30, 'C30': 69, 'C31': 98, 'C32': 117, 'C33': 126, 'C34': 136, 'C35': 141, 'C36': 171,
                        'C37': 150, 'C38': 165, 'C39': 202, 'C40': 158, 'C41': 170},
                 'C5': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                        'D9': 9999, 'D10': 9999, 'S1': 110.0, 'S2': 164, 'C1': 94.0, 'C2': 94, 'C3': 43, 'C4': 46,
                        'C5': 0, 'C6': 121, 'C7': 30, 'C8': 114, 'C9': 39, 'C10': 191, 'C11': 11.0, 'C12': 17,
                        'C13': 52, 'C14': 132, 'C15': 43, 'C16': 123, 'C17': 113, 'C18': 112, 'C19': 116, 'C20': 76,
                        'C21': 19, 'C22': 24, 'C23': 106, 'C24': 37.0, 'C25': 131, 'C26': 77, 'C27': 137, 'C28': 41.0,
                        'C29': 34, 'C30': 83, 'C31': 59, 'C32': 131, 'C33': 92, 'C34': 150, 'C35': 155, 'C36': 200,
                        'C37': 164, 'C38': 179, 'C39': 216, 'C40': 172, 'C41': 184},
                 'C6': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                        'D9': 9999, 'D10': 9999, 'S1': 125.0, 'S2': 100, 'C1': 26.0, 'C2': 26, 'C3': 130, 'C4': 155,
                        'C5': 121, 'C6': 0, 'C7': 93, 'C8': 27, 'C9': 117, 'C10': 94, 'C11': 129.0, 'C12': 121,
                        'C13': 138, 'C14': 48, 'C15': 128, 'C16': 30, 'C17': 26, 'C18': 43, 'C19': 13, 'C20': 46,
                        'C21': 128, 'C22': 110, 'C23': 35, 'C24': 145.0, 'C25': 34, 'C26': 66, 'C27': 46, 'C28': 150.0,
                        'C29': 137, 'C30': 89, 'C31': 145, 'C32': 39, 'C33': 28, 'C34': 104, 'C35': 109, 'C36': 90,
                        'C37': 100, 'C38': 118, 'C39': 148, 'C40': 121, 'C41': 113},
                 'C7': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                        'D9': 9999, 'D10': 9999, 'S1': 30.0, 'S2': 191, 'C1': 67.0, 'C2': 68, 'C3': 34, 'C4': 82,
                        'C5': 30, 'C6': 93, 'C7': 0, 'C8': 86, 'C9': 24, 'C10': 164, 'C11': 42.0, 'C12': 45, 'C13': 42,
                        'C14': 122, 'C15': 82, 'C16': 96, 'C17': 86, 'C18': 85, 'C19': 86, 'C20': 49, 'C21': 62,
                        'C22': 15, 'C23': 67, 'C24': 67.0, 'C25': 105, 'C26': 50, 'C27': 108, 'C28': 74.0, 'C29': 72,
                        'C30': 121, 'C31': 50, 'C32': 113, 'C33': 66, 'C34': 171, 'C35': 194, 'C36': 183, 'C37': 193,
                        'C38': 211, 'C39': 240, 'C40': 211, 'C41': 209},
                 'C8': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                        'D9': 9999, 'D10': 9999, 'S1': 45.0, 'S2': 109, 'C1': 20.0, 'C2': 21, 'C3': 123, 'C4': 143,
                        'C5': 114, 'C6': 27, 'C7': 86, 'C8': 0, 'C9': 107, 'C10': 113, 'C11': 118.0, 'C12': 111,
                        'C13': 128, 'C14': 36, 'C15': 116, 'C16': 10, 'C17': 36, 'C18': 40, 'C19': 40, 'C20': 35,
                        'C21': 117, 'C22': 100, 'C23': 23, 'C24': 135.0, 'C25': 55, 'C26': 56, 'C27': 28, 'C28': 139.0,
                        'C29': 124, 'C30': 77, 'C31': 135, 'C32': 27, 'C33': 21, 'C34': 85, 'C35': 99, 'C36': 98,
                        'C37': 108, 'C38': 126, 'C39': 156, 'C40': 129, 'C41': 124},
                 'C9': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                        'D9': 9999, 'D10': 9999, 'S1': 18.0, 'S2': 200, 'C1': 91.0, 'C2': 91, 'C3': 33, 'C4': 85,
                        'C5': 39, 'C6': 117, 'C7': 24, 'C8': 107, 'C9': 0, 'C10': 188, 'C11': 46.0, 'C12': 53,
                        'C13': 27, 'C14': 146, 'C15': 79, 'C16': 120, 'C17': 111, 'C18': 109, 'C19': 113, 'C20': 73,
                        'C21': 55, 'C22': 16, 'C23': 103, 'C24': 77.0, 'C25': 129, 'C26': 74, 'C27': 135, 'C28': 77.0,
                        'C29': 70, 'C30': 119, 'C31': 51, 'C32': 137, 'C33': 90, 'C34': 186, 'C35': 190, 'C36': 207,
                        'C37': 199, 'C38': 214, 'C39': 251, 'C40': 208, 'C41': 220},
                 'C10': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 31.0, 'S2': 153, 'C1': 94.0, 'C2': 95, 'C3': 200, 'C4': 224,
                         'C5': 191, 'C6': 94, 'C7': 164, 'C8': 113, 'C9': 188, 'C10': 0, 'C11': 198.0, 'C12': 191,
                         'C13': 208, 'C14': 130, 'C15': 212, 'C16': 123, 'C17': 78, 'C18': 87, 'C19': 123, 'C20': 115,
                         'C21': 197, 'C22': 180, 'C23': 105, 'C24': 215.0, 'C25': 59, 'C26': 135, 'C27': 124,
                         'C28': 219.0, 'C29': 208, 'C30': 173, 'C31': 215, 'C32': 121, 'C33': 98, 'C34': 156,
                         'C35': 161, 'C36': 143, 'C37': 152, 'C38': 171, 'C39': 200, 'C40': 173, 'C41': 168},
                 'C11': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 70.0, 'S2': 155, 'C1': 103.0, 'C2': 103, 'C3': 50, 'C4': 37,
                         'C5': 11, 'C6': 129, 'C7': 42, 'C8': 118, 'C9': 46, 'C10': 198, 'C11': 0.0, 'C12': 9,
                         'C13': 59, 'C14': 123, 'C15': 35, 'C16': 132, 'C17': 122, 'C18': 120, 'C19': 122, 'C20': 84,
                         'C21': 10, 'C22': 31, 'C23': 114, 'C24': 28.0, 'C25': 140, 'C26': 85, 'C27': 132, 'C28': 33.0,
                         'C29': 26, 'C30': 74, 'C31': 66, 'C32': 122, 'C33': 101, 'C34': 174, 'C35': 147, 'C36': 191,
                         'C37': 155, 'C38': 170, 'C39': 207, 'C40': 164, 'C41': 175},
                 'C12': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 72.0, 'S2': 147, 'C1': 95.0, 'C2': 59, 'C3': 57, 'C4': 32,
                         'C5': 17, 'C6': 121, 'C7': 45, 'C8': 111, 'C9': 53, 'C10': 191, 'C11': 9.0, 'C12': 0,
                         'C13': 66, 'C14': 114, 'C15': 26, 'C16': 124, 'C17': 115, 'C18': 113, 'C19': 117, 'C20': 77,
                         'C21': 7, 'C22': 38, 'C23': 107, 'C24': 24.0, 'C25': 9, 'C26': 78, 'C27': 124, 'C28': 29.0,
                         'C29': 17, 'C30': 66, 'C31': 73, 'C32': 113, 'C33': 94, 'C34': 133, 'C35': 138, 'C36': 183,
                         'C37': 146, 'C38': 162, 'C39': 199, 'C40': 155, 'C41': 167},
                 'C13': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 27.0, 'S2': 213, 'C1': 113.0, 'C2': 140, 'C3': 11, 'C4': 91,
                         'C5': 52, 'C6': 138, 'C7': 42, 'C8': 128, 'C9': 27, 'C10': 208, 'C11': 59.0, 'C12': 66,
                         'C13': 0, 'C14': 167, 'C15': 92, 'C16': 142, 'C17': 132, 'C18': 76, 'C19': 135, 'C20': 71,
                         'C21': 121, 'C22': 135, 'C23': 59, 'C24': 118.0, 'C25': 66, 'C26': 91, 'C27': 156,
                         'C28': 114.0, 'C29': 98, 'C30': 51, 'C31': 170, 'C32': 9, 'C33': 56, 'C34': 50, 'C35': 63,
                         'C36': 66, 'C37': 67, 'C38': 86, 'C39': 115, 'C40': 88, 'C41': 83},
                 'C14': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 120.0, 'S2': 69, 'C1': 55.0, 'C2': 34, 'C3': 158, 'C4': 118,
                         'C5': 132, 'C6': 48, 'C7': 122, 'C8': 36, 'C9': 146, 'C10': 130, 'C11': 123.0, 'C12': 114,
                         'C13': 167, 'C14': 0, 'C15': 92, 'C16': 142, 'C17': 132, 'C18': 76, 'C19': 60, 'C20': 71,
                         'C21': 121, 'C22': 135, 'C23': 59, 'C24': 118.0, 'C25': 66, 'C26': 91, 'C27': 20, 'C28': 114.0,
                         'C29': 98, 'C30': 51, 'C31': 170, 'C32': 9, 'C33': 56, 'C34': 50, 'C35': 63, 'C36': 66,
                         'C37': 67, 'C38': 86, 'C39': 115, 'C40': 88, 'C41': 83},
                 'C15': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 110.0, 'S2': 122, 'C1': 121.0, 'C2': 115, 'C3': 82, 'C4': 27,
                         'C5': 43, 'C6': 128, 'C7': 82, 'C8': 116, 'C9': 79, 'C10': 212, 'C11': 34.8, 'C12': 26,
                         'C13': 92, 'C14': 92, 'C15': 0, 'C16': 106, 'C17': 141, 'C18': 139, 'C19': 144, 'C20': 103,
                         'C21': 33, 'C22': 64, 'C23': 133, 'C24': 27.0, 'C25': 26, 'C26': 104, 'C27': 99, 'C28': 22.0,
                         'C29': 10, 'C30': 42, 'C31': 99, 'C32': 89, 'C33': 120, 'C34': 109, 'C35': 114, 'C36': 144,
                         'C37': 122, 'C38': 128, 'C39': 175, 'C40': 131, 'C41': 143},
                 'C16': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 100.0, 'S2': 98, 'C1': 30.0, 'C2': 16, 'C3': 132, 'C4': 133,
                         'C5': 123, 'C6': 30, 'C7': 96, 'C8': 10, 'C9': 120, 'C10': 123, 'C11': 132.0, 'C12': 124,
                         'C13': 142, 'C14': 142, 'C15': 106, 'C16': 0, 'C17': 46, 'C18': 50, 'C19': 50, 'C20': 45,
                         'C21': 127, 'C22': 110, 'C23': 33, 'C24': 133.0, 'C25': 125, 'C26': 66, 'C27': 43,
                         'C28': 129.0, 'C29': 114, 'C30': 67, 'C31': 145, 'C32': 17, 'C33': 30, 'C34': 75, 'C35': 88,
                         'C36': 88, 'C37': 97, 'C38': 116, 'C39': 145, 'C40': 119, 'C41': 114},
                 'C17': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 53.0, 'S2': 124, 'C1': 18.0, 'C2': 38, 'C3': 123, 'C4': 147,
                         'C5': 113, 'C6': 26, 'C7': 86, 'C8': 36, 'C9': 111, 'C10': 78, 'C11': 122.0, 'C12': 115,
                         'C13': 132, 'C14': 132, 'C15': 141, 'C16': 46, 'C17': 0, 'C18': 17, 'C19': 22, 'C20': 38,
                         'C21': 120, 'C22': 103, 'C23': 28, 'C24': 137.0, 'C25': 115, 'C26': 58, 'C27': 22,
                         'C28': 147.0, 'C29': 130, 'C30': 112, 'C31': 138, 'C32': 62, 'C33': 21, 'C34': 121, 'C35': 133,
                         'C36': 114, 'C37': 124, 'C38': 142, 'C39': 372, 'C40': 145, 'C41': 140},
                 'C18': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 125.0, 'S2': 144, 'C1': 20.0, 'C2': 52, 'C3': 121, 'C4': 145,
                         'C5': 112, 'C6': 43, 'C7': 85, 'C8': 40, 'C9': 109, 'C10': 87, 'C11': 120.0, 'C12': 113,
                         'C13': 76, 'C14': 76, 'C15': 139, 'C16': 50, 'C17': 17, 'C18': 0, 'C19': 42, 'C20': 37,
                         'C21': 119, 'C22': 101, 'C23': 32, 'C24': 136.0, 'C25': 113, 'C26': 57, 'C27': 42,
                         'C28': 146.0, 'C29': 129, 'C30': 117, 'C31': 136, 'C32': 66, 'C33': 20, 'C34': 125, 'C35': 138,
                         'C36': 131, 'C37': 141, 'C38': 159, 'C39': 188, 'C40': 162, 'C41': 157},
                 'C19': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 18.0, 'S2': 111, 'C1': 24.0, 'C2': 26, 'C3': 126, 'C4': 58,
                         'C5': 116, 'C6': 13, 'C7': 86, 'C8': 40, 'C9': 113, 'C10': 123, 'C11': 122.0, 'C12': 117,
                         'C13': 135, 'C14': 60, 'C15': 144, 'C16': 50, 'C17': 22, 'C18': 42, 'C19': 0, 'C20': 42,
                         'C21': 96, 'C22': 107, 'C23': 32, 'C24': 142.0, 'C25': 31, 'C26': 63, 'C27': 59, 'C28': 145.0,
                         'C29': 133, 'C30': 102, 'C31': 142, 'C32': 51, 'C33': 23, 'C34': 115, 'C35': 120, 'C36': 102,
                         'C37': 110, 'C38': 129, 'C39': 159, 'C40': 132, 'C41': 127},
                 'C20': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 20.0, 'S2': 144, 'C1': 20.0, 'C2': 47, 'C3': 85, 'C4': 109,
                         'C5': 76, 'C6': 46, 'C7': 49, 'C8': 35, 'C9': 73, 'C10': 115, 'C11': 84.0, 'C12': 77,
                         'C13': 71, 'C14': 71, 'C15': 103, 'C16': 45, 'C17': 38, 'C18': 37, 'C19': 42, 'C20': 0,
                         'C21': 84, 'C22': 66, 'C23': 30, 'C24': 101.0, 'C25': 57, 'C26': 23, 'C27': 64, 'C28': 111.0,
                         'C29': 94, 'C30': 117, 'C31': 10, 'C32': 67, 'C33': 17, 'C34': 148, 'C35': 153, 'C36': 134,
                         'C37': 143, 'C38': 162, 'C39': 192, 'C40': 165, 'C41': 160},
                 'C21': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 110.0, 'S2': 153, 'C1': 102.0, 'C2': 130, 'C3': 58, 'C4': 27,
                         'C5': 19, 'C6': 128, 'C7': 62, 'C8': 117, 'C9': 55, 'C10': 197, 'C11': 10.0, 'C12': 7,
                         'C13': 121, 'C14': 121, 'C15': 33, 'C16': 127, 'C17': 120, 'C18': 119, 'C19': 96, 'C20': 84,
                         'C21': 0, 'C22': 40, 'C23': 113, 'C24': 18.0, 'C25': 140, 'C26': 85, 'C27': 130, 'C28': 22.0,
                         'C29': 24, 'C30': 72, 'C31': 75, 'C32': 120, 'C33': 104, 'C34': 141, 'C35': 145, 'C36': 189,
                         'C37': 155, 'C38': 169, 'C39': 205, 'C40': 190, 'C41': 174},
                 'C22': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 20.0, 'S2': 184, 'C1': 84.0, 'C2': 112, 'C3': 19, 'C4': 70,
                         'C5': 24, 'C6': 110, 'C7': 15, 'C8': 100, 'C9': 16, 'C10': 180, 'C11': 31.0, 'C12': 38,
                         'C13': 135, 'C14': 135, 'C15': 64, 'C16': 110, 'C17': 103, 'C18': 101, 'C19': 107, 'C20': 66,
                         'C21': 40, 'C22': 0, 'C23': 94, 'C24': 58.0, 'C25': 122, 'C26': 67, 'C27': 132, 'C28': 62.0,
                         'C29': 55, 'C30': 103, 'C31': 36, 'C32': 130, 'C33': 86, 'C34': 172, 'C35': 176, 'C36': 200,
                         'C37': 186, 'C38': 208, 'C39': 236, 'C40': 221, 'C41': 224},
                 'C23': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 115.0, 'S2': 134, 'C1': 12.0, 'C2': 35, 'C3': 115, 'C4': 139,
                         'C5': 106, 'C6': 35, 'C7': 67, 'C8': 23, 'C9': 103, 'C10': 105, 'C11': 114.0, 'C12': 107,
                         'C13': 59, 'C14': 59, 'C15': 133, 'C16': 33, 'C17': 28, 'C18': 32, 'C19': 32, 'C20': 30,
                         'C21': 113, 'C22': 94, 'C23': 0, 'C24': 131.0, 'C25': 54, 'C26': 48, 'C27': 51, 'C28': 137.0,
                         'C29': 120, 'C30': 99, 'C31': 127, 'C32': 49, 'C33': 13, 'C34': 108, 'C35': 143, 'C36': 121,
                         'C37': 133, 'C38': 153, 'C39': 182, 'C40': 152, 'C41': 149},
                 'C24': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 125.0, 'S2': 150, 'C1': 119.0, 'C2': 142, 'C3': 73, 'C4': 9,
                         'C5': 37, 'C6': 145, 'C7': 67, 'C8': 135, 'C9': 77, 'C10': 215, 'C11': 28.0, 'C12': 24,
                         'C13': 118, 'C14': 118, 'C15': 27, 'C16': 133, 'C17': 137, 'C18': 136, 'C19': 142, 'C20': 101,
                         'C21': 18, 'C22': 58, 'C23': 131, 'C24': 0.0, 'C25': 158, 'C26': 102, 'C27': 126, 'C28': 4.7,
                         'C29': 36, 'C30': 69, 'C31': 93, 'C32': 117, 'C33': 121, 'C34': 138, 'C35': 142, 'C36': 186,
                         'C37': 151, 'C38': 172, 'C39': 202, 'C40': 158, 'C41': 170},
                 'C25': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 100.0, 'S2': 116, 'C1': 37.0, 'C2': 47, 'C3': 141, 'C4': 165,
                         'C5': 131, 'C6': 34, 'C7': 105, 'C8': 55, 'C9': 129, 'C10': 59, 'C11': 140.0, 'C12': 9,
                         'C13': 66, 'C14': 66, 'C15': 26, 'C16': 125, 'C17': 115, 'C18': 113, 'C19': 31, 'C20': 57,
                         'C21': 140, 'C22': 122, 'C23': 54, 'C24': 158.0, 'C25': 0, 'C26': 78, 'C27': 407, 'C28': 167.0,
                         'C29': 150, 'C30': 123, 'C31': 157, 'C32': 73, 'C33': 40, 'C34': 120, 'C35': 124, 'C36': 106,
                         'C37': 116, 'C38': 134, 'C39': 163, 'C40': 137, 'C41': 132},
                 'C26': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 15.0, 'S2': 164, 'C1': 40.0, 'C2': 68, 'C3': 86, 'C4': 110,
                         'C5': 77, 'C6': 66, 'C7': 50, 'C8': 56, 'C9': 74, 'C10': 135, 'C11': 85.0, 'C12': 78,
                         'C13': 91, 'C14': 91, 'C15': 104, 'C16': 66, 'C17': 58, 'C18': 57, 'C19': 63, 'C20': 23,
                         'C21': 85, 'C22': 67, 'C23': 48, 'C24': 102.0, 'C25': 78, 'C26': 0, 'C27': 442, 'C28': 107.0,
                         'C29': 95, 'C30': 135, 'C31': 102, 'C32': 84, 'C33': 38, 'C34': 169, 'C35': 157, 'C36': 155,
                         'C37': 165, 'C38': 183, 'C39': 212, 'C40': 186, 'C41': 181},
                 'C27': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 45.0, 'S2': 100, 'C1': 46.0, 'C2': 33, 'C3': 147, 'C4': 126,
                         'C5': 137, 'C6': 46, 'C7': 108, 'C8': 28, 'C9': 135, 'C10': 124, 'C11': 132.0, 'C12': 124,
                         'C13': 156, 'C14': 20, 'C15': 99, 'C16': 43, 'C17': 22, 'C18': 42, 'C19': 59, 'C20': 64,
                         'C21': 130, 'C22': 132, 'C23': 51, 'C24': 126.0, 'C25': 407, 'C26': 442, 'C27': 0,
                         'C28': 351.0, 'C29': 363, 'C30': 343, 'C31': 437, 'C32': 368, 'C33': 417, 'C34': 314,
                         'C35': 300, 'C36': 327, 'C37': 291, 'C38': 275, 'C39': 295, 'C40': 287, 'C41': 312},
                 'C28': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 130.0, 'S2': 146, 'C1': 124.0, 'C2': 138, 'C3': 78, 'C4': 5,
                         'C5': 41, 'C6': 150, 'C7': 74, 'C8': 139, 'C9': 77, 'C10': 219, 'C11': 33.0, 'C12': 29,
                         'C13': 114, 'C14': 114, 'C15': 22, 'C16': 129, 'C17': 147, 'C18': 146, 'C19': 145, 'C20': 111,
                         'C21': 22, 'C22': 62, 'C23': 137, 'C24': 4.7, 'C25': 167, 'C26': 107, 'C27': 351, 'C28': 0.0,
                         'C29': 31, 'C30': 65, 'C31': 94, 'C32': 113, 'C33': 122, 'C34': 132, 'C35': 137, 'C36': 167,
                         'C37': 146, 'C38': 151, 'C39': 198, 'C40': 154, 'C41': 166},
                 'C29': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 25.0, 'S2': 131, 'C1': 112.0, 'C2': 123, 'C3': 74, 'C4': 30,
                         'C5': 34, 'C6': 137, 'C7': 72, 'C8': 124, 'C9': 70, 'C10': 208, 'C11': 26.0, 'C12': 17,
                         'C13': 98, 'C14': 98, 'C15': 10, 'C16': 114, 'C17': 130, 'C18': 129, 'C19': 133, 'C20': 94,
                         'C21': 24, 'C22': 55, 'C23': 120, 'C24': 36.0, 'C25': 150, 'C26': 95, 'C27': 363, 'C28': 31.0,
                         'C29': 0, 'C30': 50, 'C31': 90, 'C32': 97, 'C33': 111, 'C34': 117, 'C35': 122, 'C36': 152,
                         'C37': 131, 'C38': 136, 'C39': 183, 'C40': 139, 'C41': 151},
                 'C30': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 175.0, 'S2': 87, 'C1': 96.0, 'C2': 76, 'C3': 122, 'C4': 69,
                         'C5': 83, 'C6': 89, 'C7': 121, 'C8': 77, 'C9': 119, 'C10': 173, 'C11': 74.0, 'C12': 66,
                         'C13': 51, 'C14': 51, 'C15': 42, 'C16': 67, 'C17': 112, 'C18': 117, 'C19': 102, 'C20': 117,
                         'C21': 72, 'C22': 103, 'C23': 99, 'C24': 69.0, 'C25': 123, 'C26': 135, 'C27': 343, 'C28': 65.0,
                         'C29': 50, 'C30': 0, 'C31': 139, 'C32': 50, 'C33': 97, 'C34': 60, 'C35': 79, 'C36': 104,
                         'C37': 87, 'C38': 103, 'C39': 139, 'C40': 95, 'C41': 107},
                 'C31': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 125.0, 'S2': 220, 'C1': 120.0, 'C2': 147, 'C3': 15, 'C4': 98,
                         'C5': 59, 'C6': 145, 'C7': 50, 'C8': 135, 'C9': 51, 'C10': 215, 'C11': 66.0, 'C12': 73,
                         'C13': 170, 'C14': 170, 'C15': 99, 'C16': 145, 'C17': 138, 'C18': 136, 'C19': 142, 'C20': 10,
                         'C21': 75, 'C22': 36, 'C23': 127, 'C24': 93.0, 'C25': 157, 'C26': 102, 'C27': 437, 'C28': 94.0,
                         'C29': 90, 'C30': 139, 'C31': 0, 'C32': 165, 'C33': 118, 'C34': 206, 'C35': 211, 'C36': 235,
                         'C37': 220, 'C38': 235, 'C39': 271, 'C40': 228, 'C41': 240},
                 'C32': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 55.0, 'S2': 77, 'C1': 46.0, 'C2': 26, 'C3': 149, 'C4': 117,
                         'C5': 131, 'C6': 39, 'C7': 113, 'C8': 27, 'C9': 137, 'C10': 121, 'C11': 122.0, 'C12': 113,
                         'C13': 9, 'C14': 9, 'C15': 89, 'C16': 17, 'C17': 62, 'C18': 66, 'C19': 51, 'C20': 67,
                         'C21': 120, 'C22': 130, 'C23': 49, 'C24': 117.0, 'C25': 73, 'C26': 84, 'C27': 368,
                         'C28': 113.0, 'C29': 97, 'C30': 50, 'C31': 165, 'C32': 0, 'C33': 47, 'C34': 58, 'C35': 72,
                         'C36': 79, 'C37': 89, 'C38': 98, 'C39': 132, 'C40': 110, 'C41': 101},
                 'C33': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 5.0, 'S2': 127, 'C1': 3.0, 'C2': 33, 'C3': 102, 'C4': 126,
                         'C5': 92, 'C6': 28, 'C7': 66, 'C8': 21, 'C9': 90, 'C10': 98, 'C11': 101.0, 'C12': 94,
                         'C13': 56, 'C14': 56, 'C15': 120, 'C16': 30, 'C17': 21, 'C18': 20, 'C19': 23, 'C20': 17,
                         'C21': 104, 'C22': 86, 'C23': 13, 'C24': 121.0, 'C25': 40, 'C26': 38, 'C27': 417, 'C28': 122.0,
                         'C29': 111, 'C30': 97, 'C31': 118, 'C32': 47, 'C33': 0, 'C34': 106, 'C35': 119, 'C36': 112,
                         'C37': 128, 'C38': 146, 'C39': 172, 'C40': 149, 'C41': 140},
                 'C34': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 169.0, 'S2': 4, 'C1': 105.0, 'C2': 84, 'C3': 190, 'C4': 136,
                         'C5': 150, 'C6': 104, 'C7': 171, 'C8': 85, 'C9': 186, 'C10': 156, 'C11': 174.0, 'C12': 133,
                         'C13': 50, 'C14': 50, 'C15': 109, 'C16': 75, 'C17': 121, 'C18': 125, 'C19': 115, 'C20': 148,
                         'C21': 141, 'C22': 172, 'C23': 108, 'C24': 138.0, 'C25': 120, 'C26': 169, 'C27': 314,
                         'C28': 132.0, 'C29': 117, 'C30': 60, 'C31': 206, 'C32': 58, 'C33': 106, 'C34': 0, 'C35': 14,
                         'C36': 50, 'C37': 23, 'C38': 40, 'C39': 74, 'C40': 43, 'C41': 41},
                 'C35': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 199.0, 'S2': 22, 'C1': 133.0, 'C2': 98, 'C3': 195, 'C4': 141,
                         'C5': 155, 'C6': 109, 'C7': 194, 'C8': 99, 'C9': 190, 'C10': 161, 'C11': 147.0, 'C12': 138,
                         'C13': 63, 'C14': 63, 'C15': 114, 'C16': 88, 'C17': 133, 'C18': 138, 'C19': 120, 'C20': 153,
                         'C21': 145, 'C22': 176, 'C23': 143, 'C24': 142.0, 'C25': 124, 'C26': 157, 'C27': 300,
                         'C28': 137.0, 'C29': 122, 'C30': 79, 'C31': 211, 'C32': 72, 'C33': 119, 'C34': 14, 'C35': 0,
                         'C36': 42, 'C37': 9, 'C38': 27, 'C39': 61, 'C40': 29, 'C41': 29},
                 'C36': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 182.0, 'S2': 42, 'C1': 109.0, 'C2': 89, 'C3': 219, 'C4': 171,
                         'C5': 200, 'C6': 90, 'C7': 183, 'C8': 98, 'C9': 207, 'C10': 143, 'C11': 191.0, 'C12': 183,
                         'C13': 66, 'C14': 66, 'C15': 144, 'C16': 88, 'C17': 114, 'C18': 131, 'C19': 102, 'C20': 134,
                         'C21': 189, 'C22': 200, 'C23': 121, 'C24': 186.0, 'C25': 106, 'C26': 155, 'C27': 327,
                         'C28': 167.0, 'C29': 152, 'C30': 104, 'C31': 235, 'C32': 79, 'C33': 112, 'C34': 50, 'C35': 42,
                         'C36': 0, 'C37': 36, 'C38': 54, 'C39': 62, 'C40': 57, 'C41': 30},
                 'C37': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 189.0, 'S2': 15, 'C1': 124.0, 'C2': 98, 'C3': 203, 'C4': 150,
                         'C5': 164, 'C6': 100, 'C7': 193, 'C8': 108, 'C9': 199, 'C10': 152, 'C11': 155.0, 'C12': 146,
                         'C13': 67, 'C14': 67, 'C15': 122, 'C16': 97, 'C17': 124, 'C18': 141, 'C19': 110, 'C20': 143,
                         'C21': 155, 'C22': 186, 'C23': 133, 'C24': 151.0, 'C25': 116, 'C26': 165, 'C27': 291,
                         'C28': 146.0, 'C29': 131, 'C30': 87, 'C31': 220, 'C32': 89, 'C33': 128, 'C34': 23, 'C35': 9,
                         'C36': 36, 'C37': 0, 'C38': 18, 'C39': 51, 'C40': 21, 'C41': 20},
                 'C38': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 209.0, 'S2': 30, 'C1': 142.0, 'C2': 117, 'C3': 219, 'C4': 165,
                         'C5': 179, 'C6': 118, 'C7': 211, 'C8': 126, 'C9': 214, 'C10': 171, 'C11': 170.0, 'C12': 162,
                         'C13': 86, 'C14': 86, 'C15': 128, 'C16': 116, 'C17': 142, 'C18': 159, 'C19': 129, 'C20': 162,
                         'C21': 169, 'C22': 208, 'C23': 153, 'C24': 172.0, 'C25': 134, 'C26': 183, 'C27': 275,
                         'C28': 151.0, 'C29': 136, 'C30': 103, 'C31': 235, 'C32': 98, 'C33': 146, 'C34': 40, 'C35': 27,
                         'C36': 54, 'C37': 18, 'C38': 0, 'C39': 70, 'C40': 13, 'C41': 39},
                 'C39': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 235.0, 'S2': 50, 'C1': 168.0, 'C2': 146, 'C3': 255, 'C4': 202,
                         'C5': 216, 'C6': 148, 'C7': 240, 'C8': 156, 'C9': 251, 'C10': 200, 'C11': 207.0, 'C12': 199,
                         'C13': 115, 'C14': 115, 'C15': 175, 'C16': 145, 'C17': 372, 'C18': 188, 'C19': 159, 'C20': 192,
                         'C21': 205, 'C22': 236, 'C23': 182, 'C24': 202.0, 'C25': 163, 'C26': 212, 'C27': 295,
                         'C28': 198.0, 'C29': 183, 'C30': 139, 'C31': 271, 'C32': 132, 'C33': 172, 'C34': 74, 'C35': 61,
                         'C36': 62, 'C37': 51, 'C38': 70, 'C39': 0, 'C40': 54, 'C41': 33},
                 'C40': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 211.0, 'S2': 35, 'C1': 145.0, 'C2': 120, 'C3': 212, 'C4': 158,
                         'C5': 172, 'C6': 121, 'C7': 211, 'C8': 129, 'C9': 208, 'C10': 173, 'C11': 164.0, 'C12': 155,
                         'C13': 88, 'C14': 88, 'C15': 131, 'C16': 119, 'C17': 145, 'C18': 162, 'C19': 132, 'C20': 165,
                         'C21': 190, 'C22': 221, 'C23': 152, 'C24': 158.0, 'C25': 137, 'C26': 186, 'C27': 287,
                         'C28': 154.0, 'C29': 139, 'C30': 95, 'C31': 228, 'C32': 110, 'C33': 149, 'C34': 43, 'C35': 29,
                         'C36': 57, 'C37': 21, 'C38': 13, 'C39': 54, 'C40': 0, 'C41': 29},
                 'C41': {'D1': 9999, 'D2': 9999, 'D3': 9999, 'D4': 9999, 'D5': 9999, 'D6': 9999, 'D7': 9999, 'D8': 9999,
                         'D9': 9999, 'D10': 9999, 'S1': 206.0, 'S2': 20, 'C1': 140.0, 'C2': 115, 'C3': 223, 'C4': 170,
                         'C5': 184, 'C6': 113, 'C7': 209, 'C8': 124, 'C9': 220, 'C10': 168, 'C11': 175.0, 'C12': 167,
                         'C13': 83, 'C14': 83, 'C15': 143, 'C16': 114, 'C17': 140, 'C18': 157, 'C19': 127, 'C20': 160,
                         'C21': 174, 'C22': 224, 'C23': 149, 'C24': 170.0, 'C25': 132, 'C26': 181, 'C27': 312,
                         'C28': 166.0, 'C29': 151, 'C30': 107, 'C31': 240, 'C32': 101, 'C33': 140, 'C34': 41, 'C35': 29,
                         'C36': 30, 'C37': 20, 'C38': 39, 'C39': 33, 'C40': 29, 'C41': 0}
                 }

    demands = {
        'C1': {'D1': 45.0, 'D2': 90.0, 'D3': 0.0, 'D4': 0.0, 'D5': 0.0, 'D6': 0.0, 'D7': 0.0, 'D8': 90.0, 'D9': 0.0,
               'D10': 300.0},
        'C2': {'D1': 600.0, 'D2': 0.0, 'D3': 0.0, 'D4': 0.0, 'D5': 30.0, 'D6': 0.0, 'D7': 270.0, 'D8': 0.0, 'D9': 0.0,
               'D10': 600.0},
        'C3': {'D1': 0.0, 'D2': 0.0, 'D3': 0.0, 'D4': 0.0, 'D5': 0.0, 'D6': 0.0, 'D7': 0.0, 'D8': 30.0, 'D9': 0.0,
               'D10': 225.0},
        'C4': {'D1': 150.0, 'D2': 135.0, 'D3': 132.3, 'D4': 60.0, 'D5': 60.0, 'D6': 0.0, 'D7': 72.0, 'D8': 150.0,
               'D9': 0.0, 'D10': 300.0},
        'C5': {'D1': 1500.0, 'D2': 148.5, 'D3': 756.0, 'D4': 0.0, 'D5': 75.0, 'D6': 750.0, 'D7': 0.0, 'D8': 300.0,
               'D9': 0.0, 'D10': 750.0},
        'C6': {'D1': 300.0, 'D2': 0.0, 'D3': 151.20000000000002, 'D4': 150.0, 'D5': 30.0, 'D6': 0.0, 'D7': 72.0,
               'D8': 300.0, 'D9': 75.0, 'D10': 600.0},
        'C7': {'D1': 0.0, 'D2': 90.0, 'D3': 0.0, 'D4': 72.0, 'D5': 0.0, 'D6': 0.0, 'D7': 0.0, 'D8': 0.0, 'D9': 0.0,
               'D10': 150.0},
        'C8': {'D1': 0.0, 'D2': 0.0, 'D3': 0.0, 'D4': 0.0, 'D5': 0.0, 'D6': 0.0, 'D7': 0.0, 'D8': 0.0, 'D9': 0.0,
               'D10': 300.0},
        'C9': {'D1': 30.0, 'D2': 0.0, 'D3': 94.5, 'D4': 0.0, 'D5': 30.0, 'D6': 0.0, 'D7': 72.0, 'D8': 0.0, 'D9': 0.0,
               'D10': 75.0},
        'C10': {'D1': 225.0, 'D2': 135.0, 'D3': 56.7, 'D4': 60.0, 'D5': 0.0, 'D6': 0.0, 'D7': 117.0, 'D8': 75.0,
                'D9': 150.0, 'D10': 150.0},
        'C11': {'D1': 0.0, 'D2': 0.0, 'D3': 0.0, 'D4': 0.0, 'D5': 0.0, 'D6': 0.0, 'D7': 0.0, 'D8': 0.0, 'D9': 0.0,
                'D10': 75.0},
        'C12': {'D1': 300.0, 'D2': 0.0, 'D3': 189.0, 'D4': 0.0, 'D5': 0.0, 'D6': 0.0, 'D7': 0.0, 'D8': 0.0, 'D9': 0.0,
                'D10': 300.0},
        'C13': {'D1': 30.0, 'D2': 27.0, 'D3': 94.5, 'D4': 30.0, 'D5': 15.0, 'D6': 75.0, 'D7': 13.5, 'D8': 15.0,
                'D9': 0.0, 'D10': 75.0},
        'C14': {'D1': 300.0, 'D2': 0.0, 'D3': 0.0, 'D4': 0.0, 'D5': 30.0, 'D6': 0.0, 'D7': 0.0, 'D8': 0.0, 'D9': 0.0,
                'D10': 300.0},
        'C15': {'D1': 450.0, 'D2': 0.0, 'D3': 283.5, 'D4': 195.0, 'D5': 0.0, 'D6': 0.0, 'D7': 0.0, 'D8': 0.0, 'D9': 0.0,
                'D10': 300.0},
        'C16': {'D1': 150.0, 'D2': 0.0, 'D3': 132.3, 'D4': 0.0, 'D5': 0.0, 'D6': 0.0, 'D7': 0.0, 'D8': 300.0, 'D9': 0.0,
                'D10': 150.0},
        'C17': {'D1': 180.0, 'D2': 0.0, 'D3': 132.3, 'D4': 0.0, 'D5': 0.0, 'D6': 0.0, 'D7': 148.5, 'D8': 150.0,
                'D9': 0.0, 'D10': 300.0},
        'C18': {'D1': 0.0, 'D2': 135.0, 'D3': 56.7, 'D4': 75.0, 'D5': 0.0, 'D6': 90.0, 'D7': 225.0, 'D8': 150.0,
                'D9': 0.0, 'D10': 300.0},
        'C19': {'D1': 150.0, 'D2': 90.0, 'D3': 75.60000000000001, 'D4': 0.0, 'D5': 0.0, 'D6': 45.0, 'D7': 72.0,
                'D8': 30.0, 'D9': 0.0, 'D10': 150.0},
        'C20': {'D1': 75.0, 'D2': 135.0, 'D3': 132.3, 'D4': 0.0, 'D5': 0.0, 'D6': 75.0, 'D7': 0.0, 'D8': 150.0,
                'D9': 0.0, 'D10': 300.0},
        'C21': {'D1': 0.0, 'D2': 0.0, 'D3': 113.4, 'D4': 0.0, 'D5': 0.0, 'D6': 0.0, 'D7': 0.0, 'D8': 0.0, 'D9': 0.0,
                'D10': 75.0},
        'C22': {'D1': 600.0, 'D2': 72.0, 'D3': 132.3, 'D4': 210.0, 'D5': 0.0, 'D6': 45.0, 'D7': 72.0, 'D8': 75.0,
                'D9': 150.0, 'D10': 450.0},
        'C23': {'D1': 120.0, 'D2': 45.0, 'D3': 94.5, 'D4': 0.0, 'D5': 4.5, 'D6': 105.0, 'D7': 0.0, 'D8': 0.0, 'D9': 0.0,
                'D10': 75.0},
        'C24': {'D1': 0.0, 'D2': 0.0, 'D3': 0.0, 'D4': 0.0, 'D5': 0.0, 'D6': 0.0, 'D7': 0.0, 'D8': 0.0, 'D9': 0.0,
                'D10': 75.0},
        'C25': {'D1': 150.0, 'D2': 0.0, 'D3': 0.0, 'D4': 0.0, 'D5': 0.0, 'D6': 0.0, 'D7': 135.0, 'D8': 150.0, 'D9': 0.0,
                'D10': 150.0},
        'C26': {'D1': 120.0, 'D2': 0.0, 'D3': 132.3, 'D4': 0.0, 'D5': 0.0, 'D6': 0.0, 'D7': 0.0, 'D8': 300.0,
                'D9': 75.0, 'D10': 300.0},
        'C27': {'D1': 75.0, 'D2': 0.0, 'D3': 0.0, 'D4': 0.0, 'D5': 0.0, 'D6': 0.0, 'D7': 72.0, 'D8': 0.0, 'D9': 0.0,
                'D10': 150.0},
        'C28': {'D1': 0.0, 'D2': 0.0, 'D3': 0.0, 'D4': 0.0, 'D5': 0.0, 'D6': 0.0, 'D7': 0.0, 'D8': 0.0, 'D9': 0.0,
                'D10': 75.0},
        'C29': {'D1': 150.0, 'D2': 0.0, 'D3': 132.3, 'D4': 30.0, 'D5': 0.0, 'D6': 0.0, 'D7': 0.0, 'D8': 0.0, 'D9': 0.0,
                'D10': 300.0},
        'C30': {'D1': 150.0, 'D2': 0.0, 'D3': 0.0, 'D4': 78.75, 'D5': 0.0, 'D6': 0.0, 'D7': 0.0, 'D8': 0.0, 'D9': 0.0,
                'D10': 300.0},
        'C31': {'D1': 0.0, 'D2': 0.0, 'D3': 0.0, 'D4': 0.0, 'D5': 0.0, 'D6': 0.0, 'D7': 0.0, 'D8': 150.0, 'D9': 75.0,
                'D10': 75.0},
        'C32': {'D1': 300.0, 'D2': 58.5, 'D3': 0.0, 'D4': 0.0, 'D5': 0.0, 'D6': 0.0, 'D7': 0.0, 'D8': 0.0, 'D9': 0.0,
                'D10': 75.0},
        'C33': {'D1': 0.0, 'D2': 0.0, 'D3': 0.0, 'D4': 0.0, 'D5': 0.0, 'D6': 0.0, 'D7': 0.0, 'D8': 0.0, 'D9': 0.0,
                'D10': 75.0},
        'C34': {'D1': 0.0, 'D2': 0.0, 'D3': 0.0, 'D4': 150.0, 'D5': 0.0, 'D6': 0.0, 'D7': 150.0, 'D8': 0.0, 'D9': 120.0,
                'D10': 300.0},
        'C35': {'D1': 0.0, 'D2': 0.0, 'D3': 75.0, 'D4': 75.0, 'D5': 9.0, 'D6': 0.0, 'D7': 225.0, 'D8': 0.0, 'D9': 75.0,
                'D10': 300.0},
        'C36': {'D1': 0.0, 'D2': 0.0, 'D3': 0.0, 'D4': 0.0, 'D5': 0.0, 'D6': 0.0, 'D7': 0.0, 'D8': 0.0, 'D9': 75.0,
                'D10': 450.0},
        'C37': {'D1': 2250.0, 'D2': 37.5, 'D3': 75.0, 'D4': 468.75, 'D5': 0.0, 'D6': 300.0, 'D7': 1365.0, 'D8': 150.0,
                'D9': 0.0, 'D10': 1929.0},
        'C38': {'D1': 225.0, 'D2': 0.0, 'D3': 0.0, 'D4': 45.0, 'D5': 15.0, 'D6': 75.0, 'D7': 225.0, 'D8': 0.0,
                'D9': 225.0, 'D10': 300.0},
        'C39': {'D1': 0.0, 'D2': 0.0, 'D3': 75.0, 'D4': 251.25, 'D5': 15.0, 'D6': 0.0, 'D7': 150.0, 'D8': 0.0,
                'D9': 75.0, 'D10': 750.0},
        'C40': {'D1': 75.0, 'D2': 450.0, 'D3': 75.0, 'D4': 243.75, 'D5': 0.0, 'D6': 0.0, 'D7': 150.0, 'D8': 0.0,
                'D9': 75.0, 'D10': 450.0},
        'C41': {'D1': 0.0, 'D2': 0.0, 'D3': 75.0, 'D4': 75.0, 'D5': 0.0, 'D6': 0.0, 'D7': 225.0, 'D8': 0.0, 'D9': 0.0,
                'D10': 450.0}}

    # Primary vehicle capacities
    P = {'D1': 3000, 'D2': 3000, 'D3': 3000, 'D4': 3000, 'D5': 3000,
         'D6': 3000, 'D7': 3000, 'D8': 3000, 'D9': 3000, 'D10': 3000}

    # Secondary vehicle compartment capacities
    Q = {
        'S1': {'D1': 1000, 'D2': 1000, 'D3': 1000, 'D4': 1000, 'D5': 1000,
               'D6': 1000, 'D7': 1000, 'D8': 1000, 'D9': 1000, 'D10': 1000},
        'S2': {'D1': 1000, 'D2': 1000, 'D3': 1000, 'D4': 1000, 'D5': 1000,
               'D6': 1000, 'D7': 1000, 'D8': 1000, 'D9': 1000, 'D10': 1000}
    }

    # Satellite capacities
    W = {'S1': 20000, 'S2': 20000}

    return VD, VS, VC, distances, demands, P, Q, W


def load_problem_from_file(filename):
    """Load problem data from a JSON file"""
    try:
        problem = MDMSMCVRPProblem.load_problem_instance(filename)
        if problem:
            print(f"Problem loaded successfully from {filename}")
            return problem
        else:
            print(f"Failed to load problem from {filename}")
            return None
    except Exception as e:
        print(f"Error loading problem from file: {e}")
        return None


def save_experiment_results(results, filename):
    """Save comprehensive experimental results"""
    try:
        with open(filename, 'w') as f:
            json.dump(results, f, indent=2)
        print(f"Results saved to {filename}")
    except Exception as e:
        print(f"Error saving results: {e}")


def print_best_solution_details(solution):
    """Print detailed vehicle routes and flows for the best solution"""
    print("\n" + "=" * 60)
    print("BEST SOLUTION DETAILS")
    print("=" * 60)
    print(f"Total Fitness: {solution.fitness:.2f}")

    # Get solution statistics
    stats = solution.get_route_statistics()
    print(f"Customers Served: {stats['customers_served']}/{stats['total_customers']}")
    print(f"Service Rate: {stats['service_rate']:.1%}")

    # Validation
    validation = solution.validate_solution()
    print(f"Solution Valid: {'Yes' if validation['is_valid'] else 'No'}")
    if not validation['is_valid']:
        print("Violations:", validation['violations'])

    # First echelon routes (Depots → Satellites)
    print(f"\nPrimary Vehicle Routes (Depots → Satellites):")
    for depot, route in solution.routes['E1'].items():
        satellites_count = len([s for s in route if s in solution.problem.VS])
        print(f"  Vehicle {depot}: {' → '.join(route)} ({satellites_count} satellites)")

    # Second echelon routes (Satellites → Customers)
    print(f"\nSecondary Vehicle Routes (Satellites → Customers):")
    for satellite, route in solution.routes['E2'].items():
        customers_count = len([c for c in route if c in solution.problem.VC])
        print(f"  Vehicle {satellite}: {' → '.join(route)} ({customers_count} customers)")

    # Flow information (only show non-zero flows)
    print(f"\nPrimary Vehicle Flows (Y) - Non-zero flows:")
    flow_count = 0
    for (from_node, to_node), flows in solution.flows['Y'].items():
        for depot, flow in flows.items():
            if flow > 0:
                print(f"  Y({from_node}→{to_node},{depot}) = {flow:.1f}")
                flow_count += 1
    if flow_count == 0:
        print("  No active primary flows")

    print(f"\nSecondary Vehicle Flows (Z) - Non-zero flows:")
    flow_count = 0
    for (from_node, to_node), vehicles in solution.flows['Z'].items():
        for vehicle, flows in vehicles.items():
            for depot, flow in flows.items():
                if flow > 0:
                    print(f"  Z({from_node}→{to_node},{vehicle},{depot}) = {flow:.1f}")
                    flow_count += 1
    if flow_count == 0:
        print("  No active secondary flows")


def create_convergence_plot(convergence_data, save_plot=True):
    """Create and display convergence plot"""
    try:
        plt.figure(figsize=(12, 8))

        # Main convergence plot
        plt.subplot(2, 1, 1)
        plt.plot(convergence_data, marker='o', markersize=3, linestyle='-', linewidth=2, color='blue')
        plt.title("ABC Algorithm Convergence for MDMS-MCVRP", fontsize=14, fontweight='bold')
        plt.xlabel("Iteration")
        plt.ylabel("Best Fitness")
        plt.grid(True, alpha=0.3)

        # Add best fitness annotation
        best_idx = convergence_data.index(min(convergence_data))
        best_fitness = min(convergence_data)
        plt.annotate(f'Best: {best_fitness:.2f}\nIteration: {best_idx}',
                     xy=(best_idx, best_fitness),
                     xytext=(best_idx + len(convergence_data) * 0.1,
                             best_fitness + (max(convergence_data) - min(convergence_data)) * 0.1),
                     arrowprops=dict(arrowstyle='->', color='red'),
                     fontsize=10, color='red')

        # Improvement rate plot
        plt.subplot(2, 1, 2)
        improvements = [convergence_data[i] - convergence_data[i + 1] for i in range(len(convergence_data) - 1)]
        plt.plot(improvements, marker='s', markersize=2, linestyle='-', linewidth=1, color='green')
        plt.title("Fitness Improvement per Iteration", fontsize=12)
        plt.xlabel("Iteration")
        plt.ylabel("Improvement")
        plt.grid(True, alpha=0.3)

        plt.tight_layout()

        if save_plot:
            filename = f"abc_convergence_{datetime.now().strftime('%Y%m%d_%H%M%S')}.png"
            plt.savefig(filename, dpi=300, bbox_inches='tight')
            print(f"Convergence plot saved as {filename}")

        plt.show()

    except Exception as e:
        print(f"Error creating convergence plot: {e}")


def run_single_experiment(problem, use_optuna=False, n_trials=50, custom_params=None):
    """Run a single optimization experiment"""
    print("\n" + "=" * 60)
    print("STARTING OPTIMIZATION EXPERIMENT")
    print("=" * 60)

    start_time = time.time()

    if custom_params:
        print("Using custom parameters:")
        for param, value in custom_params.items():
            print(f"  {param}: {value}")
        abc = MDMSMCVRP_ABC(problem, **custom_params)

    elif use_optuna:
        print(f"Running Optuna hyperparameter tuning with {n_trials} trials...")
        try:
            best_params = optimize_with_optuna(problem, n_trials=n_trials)
            print("\nBest parameters found by Optuna:")
            for param, value in best_params.items():
                print(f"  {param:>20}: {value}")
            abc = MDMSMCVRP_ABC(problem, **best_params)
        except Exception as e:
            print(f"Error in Optuna optimization: {e}")
            print("Falling back to default parameters...")
            abc = MDMSMCVRP_ABC(problem, swarm_size=50, max_iterations=200)
    else:
        print("Running ABC with default parameters...")
        abc = MDMSMCVRP_ABC(problem, swarm_size=50, max_iterations=200)

    # Run optimization
    best_solution, convergence = abc.optimize()

    end_time = time.time()
    execution_time = end_time - start_time

    print(f"\nOptimization completed in {execution_time:.2f} seconds")

    # Print detailed solution information
    print_best_solution_details(best_solution)

    # Create convergence plot
    create_convergence_plot(convergence)

    # Prepare results summary
    results = {
        'timestamp': datetime.now().isoformat(),
        'execution_time_seconds': execution_time,
        'algorithm_parameters': {
            'swarm_size': abc.swarm_size,
            'max_iterations': abc.max_iterations,
            'employed_ratio': abc.employed_ratio,
            'onlooker_ratio': abc.onlooker_ratio,
            'limit': abc.limit
        },
        'best_fitness': float(best_solution.fitness),
        'convergence_curve': [float(x) for x in convergence],
        'improvements_count': abc.improvements_count,
        'solution_statistics': best_solution.get_route_statistics(),
        'solution_validation': best_solution.validate_solution(),
        'problem_summary': problem.get_problem_summary()
    }

    return best_solution, results


def run_comparative_study(problem):
    """Run multiple experiments for comparison"""
    print("\n" + "=" * 60)
    print("RUNNING COMPARATIVE STUDY")
    print("=" * 60)

    experiments = [
        {'name': 'Small Swarm', 'params': {'swarm_size': 20, 'max_iterations': 100}},
        {'name': 'Medium Swarm', 'params': {'swarm_size': 50, 'max_iterations': 200}},
        {'name': 'Large Swarm', 'params': {'swarm_size': 100, 'max_iterations': 300}},
        {'name': 'High Exploration',
         'params': {'swarm_size': 50, 'max_iterations': 200, 'employed_ratio': 0.7, 'onlooker_ratio': 0.2}},
        {'name': 'High Exploitation',
         'params': {'swarm_size': 50, 'max_iterations': 200, 'employed_ratio': 0.3, 'onlooker_ratio': 0.5}}
    ]

    comparative_results = {}

    for exp in experiments:
        print(f"\nRunning experiment: {exp['name']}")
        solution, results = run_single_experiment(problem, custom_params=exp['params'])
        comparative_results[exp['name']] = results

    # Print comparison summary
    print("\n" + "=" * 60)
    print("COMPARATIVE RESULTS SUMMARY")
    print("=" * 60)
    print(f"{'Experiment':<20} {'Best Fitness':<15} {'Time (s)':<10} {'Improvements':<12}")
    print("-" * 60)

    for name, results in comparative_results.items():
        print(
            f"{name:<20} {results['best_fitness']:<15.2f} {results['execution_time_seconds']:<10.2f} {results['improvements_count']:<12}")

    # Save comparative results
    save_experiment_results(comparative_results, f"comparative_results_{datetime.now().strftime('%Y%m%d_%H%M%S')}.json")

    return comparative_results


def main(mode='single', use_optuna=False, n_trials=50):
    """
    Main function to run MDMS-MCVRP optimization

    Args:
        mode: 'single' for single run, 'comparative' for multiple experiments
        use_optuna: Whether to use Optuna for hyperparameter tuning
        n_trials: Number of Optuna trials
    """
    try:
        # Load problem data
        print("Loading problem data...")
        VD, VS, VC, distances, demands, P, Q, W = load_problem_data()
        problem = MDMSMCVRPProblem(VD, VS, VC, distances, demands, P, Q, W)

        # Print problem summary
        problem.print_problem_summary()

        # Save problem instance for reproducibility
        problem.save_problem_instance(f"problem_instance_{datetime.now().strftime('%Y%m%d_%H%M%S')}.json")

        if mode == 'single':
            # Run single optimization experiment
            best_solution, results = run_single_experiment(problem, use_optuna=use_optuna, n_trials=n_trials)

            # Save results
            save_experiment_results(results, f"experiment_results_{datetime.now().strftime('%Y%m%d_%H%M%S')}.json")

        elif mode == 'comparative':
            # Run comparative study
            comparative_results = run_comparative_study(problem)

        else:
            print(f"Unknown mode: {mode}. Use 'single' or 'comparative'")

    except Exception as e:
        print(f"Error in main execution: {e}")
        import traceback
        traceback.print_exc()


def reproduce_results(solution_filename):
    """Reproduce results from a saved solution file"""
    try:
        print(f"Reproducing results from {solution_filename}...")

        # Load the solution
        solution = MDMSMCVRP_ABC.load_solution(solution_filename)
        if solution:
            print("Solution loaded successfully!")
            print_best_solution_details(solution)
        else:
            print("Failed to load solution.")

    except Exception as e:
        print(f"Error reproducing results: {e}")


if __name__ == "__main__":
    # Choose your execution mode:

    # 1. Single optimization with Optuna tuning (recommended)
    main(mode='single', use_optuna=True, n_trials=300)

    # 2. Single optimization with default parameters
    # main(mode='single', use_optuna=False)

    # 3. Comparative study of different parameter configurations
    # main(mode='comparative')

    # 4. Reproduce results from a saved solution
    # reproduce_results('best_solution.pkl')
